---
title: 云端图片、视频处理体系
tags: cloud process sys
---

# 背景

作为现代科技的重要组成部分，云端图片、视频处理的体系，为我们提供了广泛而强大的工具，极大地拓展了数字媒体处理的领域。通过将图片和视频处理移至云端，我们能够享受到更高效、灵活、可扩展的服务，能够方便、快捷、高效地服务个人用户、企业和开发者。

# 发展历程
PS:该模块，有点废话了，不感兴趣的人直接跳过，看：[怎么搭建](#怎么搭建)

云端图片、视频处理的发展历程是一个与云计算技术和网络基础设施发展紧密相连的过程。以下是云端图片视频处理的发展史的主要阶段：

## **起步阶段（2000年前）：**

云端图片视频处理在早期主要受限于网络带宽、计算资源和存储技术的限制。由于云计算概念尚未充分发展，图片、视频计算主要依赖于本地设备进行（简称：端处理），优势：隐私性好、方便、快捷，劣势：受到硬件性能限制非常大。

## **初期云计算服务（2006年-2010年）：**

随着云计算概念的提出，云服务提供商如Amazon Web Services (AWS)、Google Cloud Platform (GCP)
、国内的阿里云等开始推出基础的云计算服务。图片、视频处理逐渐开始迁移到云端，但，规模和复杂性仍受限于当时的技术水平。

## **云端计算技术逐渐成熟（2011年-2015年）：**

在这一时期，云计算技术不断发展，云服务商提供了更多的计算、存储和网络资源。图片、视频处理也逐渐脱离本地设备，转向云端进行，提高了处理速度和效率。此时期，许多基础的图像处理和编解码服务得以涌现。

## **深度学习的兴起（2016年-至今）：**

深度学习技术的兴起对云端图片视频处理产生了深远影响。深度学习算法如卷积神经网络 (CNN)
的应用使得图像和视频处理更加精确和智能。云服务商纷纷推出深度学习服务，为图像识别、人脸识别、物体检测等任务提供了强大的支持。

## **多媒体服务整合（2018年-至今）：**

云端图片、视频处理逐渐从简单的图像编辑、转换扩展到更复杂的多媒体服务整合。云服务商提供全面的多媒体处理服务，包括：图像识别、视频分析、实时流媒体处理等，为用户提供了更多选择。

## **边缘计算和5G技术的应用（2020年-至今）：**

随着边缘计算和5G技术的不断发展，云端图片视频处理在边缘设备上的应用逐渐增多。这使得实时性要求更高的应用，如智能监控、自动驾驶等，在边缘设备上能够更好地实现。

## **AIGC（2023年-至今）：**

刚过去的2023年，aigc爆火：文生图、图生图、文生视频等等，其底层技术架构体系，依旧还是：云端图片、视频计算体系。<br>
总体而言，云端图片、视频处理的发展历程是一个由基础计算到深度学习，再到整合多媒体服务，并涉及边缘计算和隐私保护的过程。未来，随着技术的不断进步，云端图片视频处理将在更多领域发挥作用，为用户提供更加强大和智能的服务。

# 怎么搭建

搭建一套：云端图片、视频处理体系，包括哪些模块呢？如下图所示：
![](/images/cps_4.png)

说明：
1、上述图展示的是：包括了多少个功能模块，并非调用顺序，各个模块的调用顺序，得根据实际功能来定，会有专门的模块来分析。
2、暂时先忽略：图里的颜色，目前并未想清楚：应该用哪些颜色来表示具体含义。

## 功能
云处理功能，用公式来表达：媒体s = fn (媒体s，参数)，这里面的媒体s，单纯地指：图片、视频、音频，带上s，证明是复数（多个），入参 + 出参都可以是多个。举些例子：
1、例子1：视频截帧，入参是：一个视频，出参是一坨的图片，动作：拼接
2、例子2：视频加logo水印：入参：视频 + logo图片 + 文字，出参：一个视频，动作：拼接
3、例子3：图片拼接：入参：2张以上的图片，出参：一张大图片，动作：拼接

## 网关域
云端图片、视频处理体系的网关，按照调用范式：可分为：同步网关 + 异步网关。对于用户而言，同步等待计算结果的显示，使用体验会更好，但是，图片、视频计算，在分配cpu触发计算之前，又只有：文件url信息等少量信息，不足于决策：分配合理核数的cpu or gpu。
因此，由负载机器去根据当前机器负载情况，去决策当前计算多少量的视频个数，能够确保整个集群的cpu or gpu，负载更均衡些，达到整个集群，相对更优。具体流程如下图所示：
![](/images/sync_2_async.png)
备注：
1、在物理机时代，更是如此，若无：同步转异步功能，非常容易导致：部分机器非常忙，部分机器非常闲。
2、在容器化时代，通过cgroup的方式，虽说能够缓解一部分负载不均的问题，但是，不能解决根本问题，而且，极容易造成成本的浪费。
3、底层计算域，最好统一通知范式：异步回调机制。
4、底层cpu or gpu可以根据自己的实际负载来拖取相关任务发起计算。
5、当业务量大时，可以由网关根据：请求入参，去初步分配使用哪个配置的：cpu池子 or gpu池子去处理，然后，再由底层机器，根据当前负载决策：拖几个任务来处理。
6、当业务方量大时，建议：单独搞一个：资源主动调度服务来处理。

## 状态域
云处理，有一个特点，用公式来表达：媒体s = fn (媒体s，参数)，
只要上述：媒体s + 参数 + fn是固定的，无论何时、何地，再次发起计算，它的结果是一样的。而；发起cpu、gpu计算又是很费成本的事情，因此，可以利用这一点，缓存一段时间的计算结果
这样，一方面：能够加速处理速度，提高体验，另外一方面：能够节约成本。
它应该包括以下功能：

### meta信息
1、记录图片：宽、高、文件大小、色域等meta信息
2、记录视频的宽、高、文件大小、视频时长、音频时长等meta信息
以上信息，均是刚需，业务侧经常使用，对获取meta信息的接口性能也有要求。建议：缓存到redis or mysql or local cache等地方，

### 索引信息
记录图片、视频的处理前后的索引信息。包括：输入媒体是哪些？经过了哪些处理？输出媒体有哪些？方便运营侧分析运营数据

### 碎片
1、业务操作不当，导致引用的内容被删除后，相对应的媒体，没有正常删除，日积月累后，成本消耗客观。
2、小文件存储系统都有分片上传功能，当分片上传完成后，一般只有一个结果文件存在。因此，中间过程需要及时清理掉，否则，日积月累后，成本消耗非常客观。
因此，业务侧通过记录：业务期许的媒体文件信息大小 跟小文件存储系统做一个对比，能够大致知道：是否有碎片的产生。

### cdn成本

### 版权宣传

### 播放体验

## 计算域

## 存储域

## 编排域

## 仿真域


